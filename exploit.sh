#!/bin/bash
echo -e "\nInitial state..."

echo -e "\n/etc/shadow:\n\n"
cat /etc/shadow || { echo "Failed to read /etc/shadow"; exit 1; }


echo -e "\nMain login.go program:\n\n"
cat /exploit/login.go || { echo "Failed to read /exploit/login.go"; exit 1; }


echo -e "\nCompiling and running login.go...\n"
go build /exploit/login.go || { echo "Compilation failed"; exit 1; }
/exploit/login || { echo "Failed to run the login program"; exit 1; }


echo "Login file compilation completed."

echo -e "/etc/shadow:\n\n"
cat /etc/shadow || { echo "Failed to read /etc/shadow"; exit 1; }


if grep -q "^malicious:.*:::::::" /etc/shadow; then
    echo "Attack successful"
fi